# Consider the series GSE87495 from the GEO platform
# This series contains 6 samples of human cells in two conditions:
#   - 3 samples treated with doxycycline
#   - 3 samples with no doxycycline
# Read the csv file "GSE87495_counts.csv" into a dataframe df
# The last 6 columns contain the counts for each sample
df = read.csv("GSE87495_counts.csv")
colnames(df)
df
df[,3]
df[,4:]
dim(df)
df[,4:9]<-samples
# We want to change the names of the samples of the dataset
# Define the variable "samples"
samples = c("no_dox_1", "with_dox_2", "no_dox_3",
"with_dox_4", "no_dox_5", "with_dox_6")
df[,4:9]<-samples
# Create SummarizedExperiment object SE: subset df (counts and genes) and assign colnames and rownames to the ones created.
# assay name must be "exp1"
exp1 <-
# colData is a 6 x 1 dataframe with a STATUS variable "no_dox" or "with_dox" based on colnames
data.frame(STATUS=samples)
# Create SummarizedExperiment object SE: subset df (counts and genes) and assign colnames and rownames to the ones created.
# assay name must be "exp1"
exp1 <-
# colData is a 6 x 1 dataframe with a STATUS variable "no_dox" or "with_dox" based on colnames
colData<-data.frame(STATUS=samples)
rownames(df)
df[2]
colnames(df)
# Create SummarizedExperiment object SE: subset df (counts and genes) and assign colnames and rownames to the ones created.
# assay name must be "exp1"
exp1 <-df[4]
df[3]
df[3]
df[3]
df[3]
df[3]
colnames(df)
colnames(df)
dim(df)
colnames(df)
# colData is a 6 x 1 dataframe with a STATUS variable "no_dox" or "with_dox" based on colnames
colData<-data.frame(STATUS=samples)
SummarizedExperiment(assays=list(counts=df[3:9]), colData=colData)
# Add dataType="rseq" as metadata.
library(SummarizedExperiment)
SummarizedExperiment(assays=list(counts=df[3:9]), colData=colData)
df[3:9]
SummarizedExperiment(assays=list(counts=df[3:9]), colData=colData)
SummarizedExperiment(assays=list(counts=df), colData=colData)
rownames(df)
rownames(df)<- df[4]
df[4]
df[3]
rownames(df)<- df[3]
SummarizedExperiment(assays=list(counts=df), colData=colData)
df[3]
rownames(df)<- df[3]
df
rownames(df)<- df[3]
df <- data.frame(chr="chr2", start = 11:15, end = 12:16,
strand = c("+", "-", "+", "*", "."), expr0 = 3:7,
expr1 = 8:12, expr2 = 12:16,
row.names = paste0("GENE", letters[5:1]))
df
exRSE <- makeSummarizedExperimentFromDataFrame(df)
exRSE
assay(exRSE)
rowRanges(exRSE)
# Consider the series GSE87495 from the GEO platform
# This series contains 6 samples of human cells in two conditions:
#   - 3 samples treated with doxycycline
#   - 3 samples with no doxycycline
# Read the csv file "GSE87495_counts.csv" into a dataframe df
# The last 6 columns contain the counts for each sample
df = read.csv("GSE87495_counts.csv")
# We want to change the names of the samples of the dataset
# Define the variable "samples"
samples = c("no_dox_1", "with_dox_2", "no_dox_3",
"with_dox_4", "no_dox_5", "with_dox_6")
colnames(df)
dim(df)
df
colnames(df)
row.names(df)
row.names(df)<-df[4]
exRSE <- makeSummarizedExperimentFromDataFrame(df[3:9],colData=colData)
exRSE <- makeSummarizedExperimentFromDataFrame(df[3:9])
df[3:9
df[3:9]
df[3:9]
exRSE <- makeSummarizedExperimentFromDataFrame(df[3:9])
df<-df[3:9]
exRSE <- makeSummarizedExperimentFromDataFrame(df)
df <- data.frame(chr="chr2", start = 11:15, end = 12:16,
strand = c("+", "-", "+", "*", "."), expr0 = 3:7,
expr1 = 8:12, expr2 = 12:16,
row.names = paste0("GENE", letters[5:1]))
df
# We want to change the names of the samples of the dataset
# Define the variable "samples"
samples = c("no_dox_0", "with_dox_1", "no_dox_2",
"with_dox_3", "no_dox_4", "with_dox_5")
# Consider the series GSE87495 from the GEO platform
# This series contains 6 samples of human cells in two conditions:
#   - 3 samples treated with doxycycline
#   - 3 samples with no doxycycline
# Read the csv file "GSE87495_counts.csv" into a dataframe df
# The last 6 columns contain the counts for each sample
df = read.csv("GSE87495_counts.csv")
# We want to change the names of the samples of the dataset
# Define the variable "samples"
samples = c("no_dox_0", "with_dox_1", "no_dox_2",
"with_dox_3", "no_dox_4", "with_dox_5")
# Change the df column names related to the samples using the names in the
# variable "samples" defined previously
df[,4:9]<-samples
SummarizedExperiment(assays=list(counts=df), colData=colData)
exRSE <- makeSummarizedExperimentFromDataFrame(df)
SummarizedExperiment(assays=list(counts=df), colData=colData)
SummarizedExperiment(assays=list(counts=df), colData=colData)
library(methods)
SummarizedExperiment(assays=list(counts=df), colData=colData)
names(df)
# Change the df column names related to the samples using the names in the
# variable "samples" defined previously
df[,4:9]<-samples
df
# Consider the series GSE87495 from the GEO platform
# This series contains 6 samples of human cells in two conditions:
#   - 3 samples treated with doxycycline
#   - 3 samples with no doxycycline
# Read the csv file "GSE87495_counts.csv" into a dataframe df
# The last 6 columns contain the counts for each sample
df = read.csv("GSE87495_counts.csv")
# We want to change the names of the samples of the dataset
# Define the variable "samples"
samples = c("no_dox_0", "with_dox_1", "no_dox_2",
"with_dox_3", "no_dox_4", "with_dox_5")
colnames(df)
colnames(df)[4:9]
colnames(df)[4:9]<-samples
colnames(df)
exRSE <- makeSummarizedExperimentFromDataFrame(df,colData=colData)
exRSE <- makeSummarizedExperimentFromDataFrame(df,colData=colData)
exRSE <- makeSummarizedExperimentFromDataFrame(df)
df
colnames(df)
df[,4]
df[,3]
rownames(df)<-df[,3]
row.names(df)<-df[,3]
row.names(df)
row.names(df)
df[,3]
rownames(df)<- df[,3]
rownames(df)
df[,3]
df[,3:9]
df2<-df[,3:9]
colData<-data.frame(STATUS=samples)
SummarizedExperiment(assays=list(counts=df2), colData=colData)
SummarizedExperiment(assays=list(counts=as.matrix(df2)), colData=colData)
coldata<-data.frame(STATUS=samples)
SummarizedExperiment(assays=list(counts=as.matrix(df2)), colData=coldata)
as.matrix(df2)
m<-as.matrix(df2)
rownames(m)
rownames(df)
rownames(df2)
rownames(df2)<-df2[,1]
SummarizedExperiment(assays=list(counts=as.matrix(df2)), colData=coldata)
nrows <- 200
ncols <- 6
counts1 <- matrix(runif(nrows * ncols, 1, 2000), nrows)
counts2 <- matrix(runif(nrows * ncols, 1, 50), nrows)
counts1
counts2 <- matrix(runif(nrows * ncols, 1, 50), nrows)
colData <- DataFrame(Treatment=rep(c("ChIP", "Input"), 3),
row.names=LETTERS[1:6])
colData <- DataFrame(Treatment=rep(c("ChIP", "Input"), 3),
row.names=LETTERS[1:6])
colData
colData
# colData is a 6 x 1 dataframe with a STATUS variable "no_dox" or "with_dox" based on colnames
coldata<-data.frame(STATUS=samples)
colData
coldata
df
data.frame(df[,4:9],row.names = df[,3])
data.frame(df[,3:9])
data.frame(df[,4:9],row.names = unique(df[3]))
data.frame(df[,4:9],row.names = unique(df[,3]))
data.frame(df[,4:9])
df<-data.frame(df[,4:9])
colData<-DataFrame(STATUS = c(0,1,0,1,0,1),
row.names=samples)
df
# Consider the series GSE87495 from the GEO platform
# This series contains 6 samples of human cells in two conditions:
#   - 3 samples treated with doxycycline
#   - 3 samples with no doxycycline
# Read the csv file "GSE87495_counts.csv" into a dataframe df
# The last 6 columns contain the counts for each sample
df = read.csv("GSE87495_counts.csv")
# We want to change the names of the samples of the dataset
# Define the variable "samples"
samples = c("no_dox_0", "with_dox_1", "no_dox_2",
"with_dox_3", "no_dox_4", "with_dox_5")
colnames(df)[4:9]<-samples
df2<-data.frame(df[,4:9])
colData<-DataFrame(STATUS = c(0,1,0,1,0,1),
row.names=samples)
df
df = read.csv("GSE87495_counts.csv")
# We want to change the names of the samples of the dataset
# Define the variable "samples"
samples = c("no_dox_0", "with_dox_1", "no_dox_2",
"with_dox_3", "no_dox_4", "with_dox_5")
colnames(df)[4:9]<-samples
df2<-data.frame(df[,4:9])
df
read.csv
df
colnames(df)[4:9]<-samples
df2<-data.frame(df[,4:9])
df2
colData<-DataFrame(STATUS = c(0,1,0,1,0,1),
row.names=samples)
df[1,]
df[,1]
df[,2]
df[,3]
colnames(df)
df[,1:3]
rowData <-df[,1:3]
se=SummarizedExperiment(assays=list(exp1=df2),
rowData = = rowData, colData=colData)
se=SummarizedExperiment(assays=list(exp1=df2),
rowData = rowData, colData=colData)
se
exp1<-assay(se)
assay(se)$dataType <-"rseq"
metadata(se)
assay(se)$dataType <-"rseq"
metadata(se)$dataType<-"rseq"
se
rowData(se)
colData
colData[c(2,4,6)]
colData$STATUS==1
colData[colData$STATUS==1]
colData$STATUS[colData$STATUS==1]
colData[colData$STATUS==1]
colData$STATUS==1
colData[2]
colData[,2]
colData[2,]
colData<-DataFrame(STATUS = c(1,1,1),
row.names=samples[c(2,4,6)])
se2=SummarizedExperiment(assays=list(exp1=df2[,c(2,4,6)]),
rowData = rowData, colData=colData)
se2
# Create a new random assay(matrix) and add it to DOX (values from normal distribution with mean = 0 and sd = 1)
# Hint: you can create a new SummarizedExperiment with 2 assays or replace the assays(DOX) list
# Hint: dimensions of the assays must be the same
nrow(df)
matrix(rnorm(nrow(df)*3),nrow=nrow(df))
nrow(df)
m<-matrix(rnorm(nrow(df)*3),nrow=nrow(df))
se2=SummarizedExperiment(assays=list(exp1=df2[,c(2,4,6)],exp2=m),
rowData = rowData, colData=colData)
se2
exp1
exp1[rowData(se)$ENTREZID = "100288801"]
rowData(se)$ENTREZID = "100288801"
rowData(se)$ENTREZID == "100288801"
exp1[rowData(se)$ENTREZID == "100288801",]
se2=SummarizedExperiment(assays=list(exp1=df2[,c(2,4,6)]),
rowData = rowData, colData=colData)
se2=SummarizedExperiment(assays=list(exp1=df2[,c(2,4,6)],exp2=m),
rowData = rowData, colData=colData)
exp1[rowData(se)$ENTREZID == "100288801",]
exp1
exp1[rowData(se)$ENTREZID == "100288801",]
rowData(se)$ENTREZID == "100288801"
rowData(se2)$ENTREZID
rowData(se2)$ENTREZID == "100288801"
exp1[rowData(se2)$ENTREZID == "100288801",]
# Donwload from AnnotationHub gtf file for Homo Sapiens
hub <- AnnotationHub()
# Donwload from AnnotationHub gtf file for Homo Sapiens
library(AnnotationDbi)
hub <- AnnotationHub()
# Donwload from AnnotationHub gtf file for Homo Sapiens
library(AnnotationHub)
hub <- AnnotationHub()
